# This file must be sourced
#
# For convenience, it installs both pyenv and nvm and is provided for a consistent build
# across all dev and build machines.
#
# It's not required to run this script if you want to specify node and python
# versions in another way.

# All tests are run (by default) with the setup required for integration tests:
export CLIMS_INTEGRATION_TEST=1

if [ ! -d ~/.pyenv ]; then
    echo "Please install pyenv: https://github.com/pyenv/pyenv and pyenv-virtualenv:"
    echo "  https://github.com/pyenv/pyenv-virtualenv.git"
    return
fi


if [ ! -d ~/.pyenv/versions/2.7.15 ]; then
    echo "Installing Python 2.7.15..."
    pyenv install 2.7.15
fi

if [ ! -d ~/.pyenv/versions/clims2 ]; then
    echo "Creating virtualenv ..."
    pyenv virtualenv 2.7.15 clims2
fi

pyenv activate clims2

./scripts/build-python-reqs

export CLIMS_PYTHON_PATH=$(which python)  # For use in e.g. vscode

source ./devboot-js
